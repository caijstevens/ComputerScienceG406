#nas 

| Flag         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 052c39b45029 | (sign) To find the signature requested in the browser page, I echoed the message on the page to a .txt file. \nThen I used openSSL command: \"openssl dgst -sha256 -sign private.pem -out signature.txt -passin pass:GA2thaE5jGkk msg.txt\" to output the digital signature to a new file which contained unknown characters, so I encoded it into base 64 and pasted it into the website.\nThen I received a different message which was encoded in base 64, so I used an online base 64 decoder and got the flag. This vulnerability is severe as it is very easy to figure out how to find the correct signature. To improve security, ensure that the private key is not accessible to unauthorised users, and use encryption for messages rather than encoding to base 64.                                                                                                                                                                                                                                                                   |
| c40cf1158800 | (inject) In the webpage HTML I found a script tag containing the line:\nlocation.href=\"secureEGIn0O9h.php\"\nI typed this into the console and it took me to the paid page. I opened the debug.js file in the head and noticed that the code appeared to be obfuscated. Using a JavaScript deobfuscator revealed that the database for the translations contained an extra Secret table called that contained a Flag attribute. \nI used the following command to reveal the flag:\n' UNION SELECT Flagoof69P4o9C FROM SecretSHN4DOKZzs --\nThen the flag was revealed.\nThis vulnerability is severe due to the resources being accessible client-side, but it is easy to reduce the likelihood of exploitation.\nTo improve the security of this, the script code to access the Pro version should be stored on server-side to prevent reverse engineering attacks through use of the console. The database schema should be harder to find and the input should be sanitised to restrict access through queries.                              |
| a85e167b3b8d | (otp) Starting by viewing the uncompiled C code, I copied it into a new file in order to preserve the original problem. Then I changed the parameter in the xor_strings() function from \"c_hash\" to \"city_hash\" to rig the parameter with the correct argument value, so that guessing was not required. \nI removed the lines that provoke the authentication questions as well as the city prompt. This causes the program to simply output the flag.\nThis vulnerability is of moderate severity, as the only major flaw is the plaintext hash in the uncompiled C code.\nTo improve the security of this, do not have uncompiled C code visible to users. Do not store the comparison hash as plaintext within the code, especially when stored within a comment in the file. 2-factor authentication should be used so that the authentication can be completed on server side, for example sending the OTP, which should be generated via true random means, to an email address or phone number.                                       |
| dae9a97517e0 | (hidden http) I sent an HTTP request to the server root. Here I found a URL that leads to a webpage which sends a message to the IP address in the parameters. I redirected the message to the virtual machine by appending \"?IP=192.168.64.4\" to the request.\nI ran the following command to begin listening for packets being sent to the host and translate them into printable ASCII form:\ntcpdump -i lo -A dst host 192.168.64.4\nI refreshed the browser to send the message and the command found and printed out a packet containing the flag encoded in base64. I used a decoder to find the flag.\nVulnerability is severe as there is no restriction to the IP the request can take as a parameter.\nTo improve the security of this, action should be taken to restrict the list of IPs that can be placed into the HTTP request. However, this is vulnerable to IP address spoofing attacks, so other authentication methods could be used to prove that the request is genuine and not part of a malicious attack.              |
| cf07ef6381f4 | (simpleke) I first decoded each line of the interaction between A and B from base64. Seeing that the message with the flag in was salted, I used the following OpenSSL command to decrypt the message containing the flag:\nopenssl base64 -d -aes-256-cbc -pbkdf2 -in encrypted.bin -out message.bin -pass pass:679058708113544840521155034321791102945\nThe pass number is the decoded interaction from B to A which is the integer encryption key detailed in the instructions.\nThis vulnerability is quite low severity as it requires the knowledge of the contents of private.pem to be able to decrypt.\nTo improve the security of this system, the passkey should not be an integer as integers are vulnerable to brute-force attacks. Also, the encryption key should be created using each user's public and private keys so that a man-in-the-middle attack cannot decrypt the contents of the messages.                                                                                                                             |
| c9be3360018a | (session2) I visited the webpage and inspected the elements. In a script tag I found a link to a different resource, so in the console I typed the following:\nlocation.href=\"secure.php\";\nThis took me to a new page which printed the flag encoded in base64, so I used a decoder to find the flag.\nLeaving pointers to sensitive resources in the client side makes this vulnerability very severe, as anyone can look through the HTML and find the link to the page containing the flag. To improve the security of this, inputs should be sent to the server before being validated, and unauthorised users should not be able to pass commands in through the console.                                                                                                                                                                                                                                                                                                                                                                 |
| 855de1f0a303 | (hidden .ignore) I used the command ls -a to show hidden files in the folder. Here I found a .ignore file which I unzipped. I then used command cat flag._parta* to concatenate every part of the flag, and I placed that into a new file flag.txt. I checked the file type, and seeing that it was a gzip file, I changed the name of my new file from flag.txt to flag.gz so that it could be gunzipped. \nAfter doing this, a new file flag was created in the folder. Reading the contents of the folder I was presented with many iterations of \"flag{notaflag}\" but with some searching I found the real flag hidden in the file.\nThis vulnerability is of moderate severity because the actual problem is fairly well hidden as well as being complicated and long-winded to solve, but the contents are unencrypted which reduces security.\nTo improve security, sensitive information should be encrypted instead of obfuscated, as anything obfuscated is easy to decode without a key in a fairly short period of time.            |
| 93ac8bb02423 | (acattack) I started by running tcpdump -i lo -A -v to listen for packets. Then I ran getflag to find a packet containing the nonce as a request parameter. I wrote a C file using the nonce and checked every pair of letters to find the secret combination which led to the same hash: JV. I made a fifo and piped it into an nc listening at port 6767.\nI ran getflag with gdb and made a breakpoint at 'connect' so I could change the port to 6767. Then I used the following to redirect to port 6767:\nset {short}0xbfffea4c = 0x6f1a\nI ran continue to have the program send a request through the port. I read the nonce, computed the hash using 'Permit' instead of 'Deny', and piped \"Permit,hash\" to the fifo to get the flag.\nThis vulnerability is severe due to weakness to brute force attack. To improve the security, secret should be complex to prevent brute force attacks. Also using TLS to encrypt the channel to prevent tcpdump access, and use timestamps in requests to avoid replay attacks.                  |
| cc3362ed8c2a | (deadcode) I opened the deadcode file using gdb, and ran disas on the main function and feedback function found in main. Creating a breakpoint at the 'leave' command address, I tested a buffer overflow using 100 \"A\"s. I checked the changes made to the pointer using x/4x $ebp.\nI inputted \"info functions\" into gdb to find the memory address containing secret_function_AAAAAA. I created a breakpoint in the same location as before. After a few trials, I found that using input of 86 \"A\"s filled the word before the goal address. I used the following command:\n(gdb) r `perl -e 'print \"A\" x 86 . \"\\x6e\\x92\\x04\\x08\"'`\nWhen I then ran (gdb) cont, the flag was displayed.\nSevere vulnerability due to danger of data theft or loss. To improve security, use a memory-safe language for the deadcode file. Also employ ASLR techniques to reduce likelihood of a successful overflow. The feedback function uses strcpy which is a weakness point; instead use strncpy to limit number of bytes for the string. |
| 5de16d733d57 | (aclivepolicy) I opened the website and inspected the page and found a small hyperlink in the top-left corner. This took me to the page to update the policy. I found the correct policy to be the following:\n\nR1:Permit if (DKHA)\nR2:Permit if AND(MKCY,ZRYJ)\nR3:DUP(R1,R2)\nR4:Deny if NOT (DKHA)\nR5:FA(R1,R3)\nP:POV(R4,R5)\n\nThis gave me the flag encoded in base64.\nThis vulnerability is of high severity as the access control policy can be found and edited through page inspection with little effort. To improve the security of this, remove the hyperlink from the webpage. Access control policies should be monitored by the server, and the server should check the identity of anyone trying to access or edit the access control policy.                                                                                                                                                                                                                                                                                |
